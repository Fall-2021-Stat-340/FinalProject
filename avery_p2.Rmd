---
title: "Project"
author: "Shawn Riemer"
date: "11/11/2021"
output:
  html_document:
    df_print: paged
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(tidyr)
library(corrplot)
library(corrr)
```

## Read in Data

```{r}
country <- read_csv("data/Country.csv", col_types = cols())
ind <- read_csv("data/Indicators.csv", col_types = cols())
```

```{r}
# Each observation is uniquely identified by CountryName/CountryCode, IndicatorName/IndicatorCode, Year
ind %>% str()
ind$Year %>% unique()
```


```{r}
# ind %>% group_by(
#   IndicatorName
# ) %>% summarise(
#   n = n()
# )

ind <- ind %>% 
  mutate(
    IndicatorName = str_replace_all(IndicatorName, " ", "_")
  )
```


```{r}
ind2 <- ind %>%
  select(CountryName, IndicatorName, Year, Value) %>%
  pivot_wider(names_from = IndicatorName,
              values_from = Value,
              values_fill = NA)

# ind2 %>% group_by(
#   CountryName
# ) %>% summarise(
#   n = n()
# )

names <- ind2 %>% colnames()

# ind2 %>% pivot_longer(cols = -(CountryName, Year))

# table(is.na(ind2))
# 5684120 / (5684120 + 12932406)

ind$IndicatorCode %>% unique() %>% length()
# 1344

max_percent_missing <- 0.1

sapply(ind2, function(x) sum(is.na (x))) %>% 
  as.data.frame() %>% 
  select(., everything()) %>% 
  arrange(-desc(.)) %>% 
  filter(. / 13823 < max_percent_missing)
```


```{r}
# ind2 %>% pivot_longer(cols = )
ind2

```

```{python eval=FALSE, include=FALSE}

# print(r.names)

# x = [n for n in r.names if !(n in ["CountryName", "Year"])]
x = []

for n in r.names:
  if n != "CountryName" and n != "Year":
    x.append(n)
# print(f"({''.join(x)})")

```








